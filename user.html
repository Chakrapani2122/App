<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Soil Microbial Agroecology Lab - Kansas State University</title>
   <style>
       body {
           display: flex;
           flex-direction: column;
           justify-content: center;
           align-items: center;
           height: 100vh;
           margin: 0;
           background: linear-gradient(to right, #6a11cb, #2575fc); /* Gradient background */
           font-family: 'Arial', sans-serif;
           color: #fff;
       }
       .welcome-note {
           font-size: 24px; /* Increased font size for the heading */
           margin-bottom: 20px;
           color: white; /* Color for the welcome message */
           text-align: center; /* Center the welcome message */
       }
       .user-card {
           background-color: white;
           border: none;
           border-radius: 20px;
           padding: 30px;
           box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
           width: 350px; /* Set width for the card */
           margin-bottom: 20px;
           text-align: center; /* Center text */
       }
       .user-card h2 {
           margin: 0 0 15px;
           color: #333; /* Darker color for the heading */
       }
       .user-card p {
           color: black; /* Change text color to black for user details */
       }
       .file-upload {
           margin-top: 20px;
           text-align: center; /* Center text */
       }
       input[type="file"] {
           padding: 10px;
           border: 1px solid #ccc;
           border-radius: 5px;
           margin-bottom: 10px; /* Space between input and button */
           width: 80%; /* Width of the file input */
       }
       select {
           padding: 10px;
           border: 1px solid #ccc;
           border-radius: 5px;
           width: 85%; /* Width of the dropdown */
           margin-bottom: 10px; /* Space between dropdown and file input */
       }
       button {
           background-color: #2575fc;
           color: white;
           padding: 10px 20px;
           border: none;
           border-radius: 5px;
           cursor: pointer;
           transition: background-color 0.3s, transform 0.2s; /* Animation effects */
           font-size: 16px;
       }
       button:hover {
           background-color: #1e5bbf; /* Darker shade on hover */
           transform: scale(1.05); /* Slightly enlarge on hover */
       }
   </style>
</head>
<body>
    
   <h2 class="welcome-note" id="welcomeNote"></h2> <!-- Welcome note as an h2 heading -->

   <div class="user-card" id="userCard">
       <h2>User Details</h2>
       <p id="userName"></p>
       <p id="userRole"></p>
   </div>

   <div class="file-upload">
       <select id="folderSelect">
           <option value="Folder1">Forage</option>
           <option value="Folder2">Soil Biology & Biochemistry</option>
           <option value="Folder3">Soil Fertility</option>
           <option value="Folder4">Soil Health</option>
           <option value="Folder5">Soil Moisture</option>
           <option value="Folder5">Soil Water Lab</option>
           <option value="Folder5">Summer Crops</option>
           <option value="Folder5">Winter Crops</option>
       </select>
       <input type="file" id="fileInput">
       <button onclick="uploadFile()">Upload</button>
   </div>

   <script>
       // Retrieve user details from local storage
       const userDetails = JSON.parse(localStorage.getItem('userDetails'));
       if (userDetails) {
           document.getElementById('welcomeNote').textContent = `Welcome, ${userDetails.firstName}!`; // Welcome note
           document.getElementById('userName').textContent = `Name: ${userDetails.firstName} ${userDetails.lastName}`;
           document.getElementById('userRole').textContent = `Role: ${userDetails.role}`;
       } else {
           alert("No user details found. Please log in.");
           window.location.href = 'index.html'; // Redirect to login page if no user details
       }

       function uploadFile() {
           const fileInput = document.getElementById('fileInput');
           const folderSelect = document.getElementById('folderSelect');
           const file = fileInput.files[0];
           const selectedFolder = folderSelect.value;

           if (file) {
               // Simulate file upload to a local folder
               alert(`File ${file.name} uploaded successfully to Data/${selectedFolder}!`);
               // Here you can add code to handle the file upload to the server
           } else {
               alert("Please select a file to upload.");
           }
       }
   </script>
   <script src="https://alcdn.msauth.net/browser/2.14.0/js/msal-browser.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/@microsoft/microsoft-graph-client/lib/graph-js-sdk-web.js"></script>
   <script>
    async function uploadFile() {
        const token = prompt("Please enter your GitHub personal access token:");
        if (!token) {
            alert("GitHub personal access token is required.");
            return;
        }

        const fileInput = document.getElementById('fileInput');
        const folderSelect = document.getElementById('folderSelect');
        const file = fileInput.files[0];
        const selectedFolder = folderSelect.value;

        if (file) {
            const reader = new FileReader();
            reader.onload = async function(event) {
                const content = btoa(event.target.result); // Base64 encode the file content

                const repoOwner = 'Chakrapani2122';
                const repoName = 'Data';
                const filePath = `${selectedFolder}/${file.name}`;
                const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;

                const data = {
                    message: `Upload ${file.name}`,
                    content: content
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });

                    if (response.ok) {
                        alert(`File ${file.name} uploaded successfully to GitHub repository!`);
                    } else {
                        const errorData = await response.json();
                        alert(`There was an error uploading your file: ${errorData.message}`);
                    }
                } catch (error) {
                    alert(`There was an error uploading your file: ${error.message}`);
                }
            };
            reader.readAsBinaryString(file);
        } else {
            alert("Please select a file to upload.");
        }
    }
</script>
</body>
</html>